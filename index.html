<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>911 Dispatch Simulation</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:Arial,sans-serif;background:linear-gradient(135deg,#1c92d2,#f2fcfe);color:#fff;min-height:100vh;display:flex;flex-direction:column;}
img{max-width:180px;margin:20px auto;border-radius:12px;display:block;}
.sidebar{background:rgba(0,0,0,0.3);width:200px;min-height:100vh;padding:20px;position:fixed;}
.sidebar h3{margin-bottom:15px;}
.sidebar button{width:100%;margin:5px 0;background:linear-gradient(to right,#2575fc,#6a11cb);padding:10px;border:none;border-radius:6px;cursor:pointer;transition:0.3s;}
.sidebar button:hover{opacity:0.9;}
.main{margin-left:220px;padding:20px;flex:1;}
.card{background:rgba(0,0,0,0.2);padding:20px;margin:15px 0;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.3);}
input,select,textarea,button{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:none;font-size:1em;}
table{width:100%;border-collapse:collapse;margin-top:15px;}
th,td{padding:10px;border:1px solid #fff;text-align:center;}
th{background:rgba(255,255,255,0.2);}
ul{list-style:none;padding-left:0;}
#liveCallList li{margin-bottom:6px;}
.status-pending{color:yellow;font-weight:bold;}
.status-waiting{color:deepskyblue;font-weight:bold;}
.status-passed{color:limegreen;font-weight:bold;}
.status-failed{color:red;font-weight:bold;}
footer{text-align:center;padding:15px;font-size:0.9em;opacity:0.8;margin-top:20px;}
p.link{cursor:pointer;text-decoration:underline;margin-top:10px;text-align:center;}
@media(max-width:768px){.sidebar{position:relative;width:100%;} .main{margin-left:0;}}
</style>
</head>
<body>

<img src="https://sdmntprnorthcentralus.oaiusercontent.com/files/00000000-7c9c-622f-ae4e-fd7da774c7d3/raw?se=2025-08-30T05%3A14%3A55Z&sp=r&sv=2024-08-04&sr=b&scid=55e111af-e330-5bff-b3f6-22bb066912e1&skoid=add8ee7d-5fc7-451e-b06e-a82b2276cf62&sktid=a48cca56-e6da-484e-a814-9c849652bcb3&skt=2025-08-29T19%3A52%3A52Z&ske=2025-08-30T19%3A52%3A52Z&sks=b&skv=2024-08-04&sig=x9S9pY9JHsODKlcYnlkjmfJnSgDpBqWTd7z6JTQQBu4%3D" alt="911 Dispatch Logo">

<!-- LOGIN -->
<div id="loginDiv" class="card">
<h2>Login</h2>
<input type="text" id="loginUser" placeholder="Username">
<input type="password" id="loginPass" placeholder="Password">
<button onclick="login(document.getElementById('loginUser').value, document.getElementById('loginPass').value)">Login</button>
<p class="link" onclick="showRequest()">Request Account</p>
</div>

<!-- REQUEST ACCOUNT -->
<div id="requestDiv" class="card" style="display:none;">
<h2>Request Account</h2>
<input type="text" id="reqUser" placeholder="Username">
<input type="password" id="reqPass" placeholder="Password">
<button onclick="requestAccount()">Request Account</button>
<p class="link" onclick="showLogin()">Back to Login</p>
<div id="reqStatus"></div>
</div>

<!-- SIDEBAR -->
<div class="sidebar" id="sidebar" style="display:none;">
<h3 id="userRole"></h3>
<button onclick="showPanel('dashboard')">Dashboard</button>
<button onclick="showPanel('live')">Live Calls</button>
<button onclick="showPanel('scenarios')">Scenarios</button>
<button onclick="showPanel('results')">Results</button>
<button onclick="showPanel('pending')" id="pendingBtn">Pending Accounts</button>
<button onclick="logout()">Logout</button>
</div>

<!-- MAIN CONTENT -->
<div class="main">
<!-- Dashboard -->
<div id="dashboard" class="card" style="display:none;">
<h2>Welcome, <span id="dashUser"></span></h2>
<p>Status: <span id="userStatus" class="status-pending">Pending Approval</span></p>
</div>

<!-- Live Calls -->
<div id="live" class="card" style="display:none;">
<h2>Live Calls</h2>
<ul id="liveCallList"></ul>
</div>

<!-- Scenarios -->
<div id="scenarios" class="card" style="display:none;">
<h2>Scenario Management</h2>
<input type="text" id="scenarioText" placeholder="Scenario Description">
<button onclick="addScenario()">Add Scenario</button>
<button onclick="deleteScenario()">Delete Last Scenario</button>
<ul id="scenarioList"></ul>
</div>

<!-- Results -->
<div id="results" class="card" style="display:none;">
<h2>All Submissions</h2>
<table id="resultsTable">
<thead>
<tr>
<th>User</th><th>Scenario</th><th>Score</th><th>Eligible</th><th>Service</th><th>Pass/Fail</th><th>Feedback</th><th>Review</th>
</tr>
</thead>
<tbody></tbody>
</table>
<button onclick="exportResults()">Export CSV</button>
</div>

<!-- Pending Accounts -->
<div id="pending" class="card" style="display:none;">
<h2>Pending Accounts</h2>
<ul id="pendingList"></ul>
</div>
</div>

<footer>
Powered by Nextwave Roleplay Development Team | Powered by Shadowisfun
</footer>

<script>
// ---------- Data ----------
let users=JSON.parse(localStorage.getItem('users'))||[];
let pendingAccounts=JSON.parse(localStorage.getItem('pendingAccounts'))||[];
let scenarios=JSON.parse(localStorage.getItem('scenarios'))||[];
let liveCalls=JSON.parse(localStorage.getItem('liveCalls'))||[];
let results=JSON.parse(localStorage.getItem('results'))||[];
let currentUser=null;

// Owner setup
if(!users.find(u=>u.username==='shadowisfun')){
users.push({username:'shadowisfun', password:'aidenfav88!', rank:'Admin'});
localStorage.setItem('users',JSON.stringify(users));
}

// ---------- Show/Hide Screens ----------
function showRequest(){document.getElementById('loginDiv').style.display='none';document.getElementById('requestDiv').style.display='block';}
function showLogin(){document.getElementById('requestDiv').style.display='none';document.getElementById('loginDiv').style.display='block';}

// ---------- Account Request ----------
function requestAccount(){
const username=document.getElementById('reqUser').value.trim();
const password=document.getElementById('reqPass').value.trim();
if(!username||!password){ alert('Fill all fields'); return; }
if(users.find(u=>u.username===username)||pendingAccounts.find(p=>p.username===username)){
alert('Username exists or pending'); return;
}
pendingAccounts.push({username,password,status:'Pending'});
localStorage.setItem('pendingAccounts',JSON.stringify(pendingAccounts));
document.getElementById('reqStatus').innerText='Waiting for High Command approval...';
document.getElementById('reqUser').value=''; document.getElementById('reqPass').value='';
}

// ---------- Login ----------
function login(username,password){
const user=users.find(u=>u.username===username&&u.password===password);
if(user){
currentUser=user;
document.getElementById('loginDiv').style.display='none';
document.getElementById('requestDiv').style.display='none';
document.getElementById('sidebar').style.display='block';
document.getElementById('dashUser').innerText=currentUser.username;
document.getElementById('userRole').innerText=currentUser.rank;
showPanel('dashboard');
updateScenarioList();
updateLiveCalls();
updatePending();
updateResults();
}else alert('Incorrect credentials or not approved yet.');
}

// ---------- Panels ----------
function showPanel(id){
['dashboard','live','scenarios','results','pending'].forEach(p=>document.getElementById(p).style.display='none');
document.getElementById(id).style.display='block';
}

// ---------- Logout ----------
function logout(){currentUser=null;document.getElementById('sidebar').style.display='none';document.getElementById('loginDiv').style.display='block';}

// ---------- Scenarios ----------
function addScenario(){const text=document.getElementById('scenarioText').value.trim();if(!text){ alert('Enter scenario'); return;} scenarios.push(text); localStorage.setItem('scenarios',JSON.stringify(scenarios)); updateScenarioList();}
function deleteScenario(){ if(scenarios.length>0){ scenarios.pop(); localStorage.setItem('scenarios',JSON.stringify(scenarios)); updateScenarioList(); } }
function updateScenarioList(){ const ul=document.getElementById('scenarioList
